{"ast":null,"code":"import _objectSpread from\"/Users/aleksandrgolomazov/anime-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/aleksandrgolomazov/anime-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/aleksandrgolomazov/anime-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/aleksandrgolomazov/anime-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import axios from'axios';var AnimeService=function AnimeService(){var _this=this;_classCallCheck(this,AnimeService);this._apiBase='https://shikimori.one/api';this.getResource=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var config,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config=_args.length>1&&_args[1]!==undefined?_args[1]:{};_context.next=3;return axios.get(\"\".concat(_this._apiBase).concat(url),{params:config});case 3:return _context.abrupt(\"return\",_context.sent.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();this.getOngoings=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(num){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={status:\"ongoing\",order:\"ranked\",limit:num};_context2.next=3;return _this.getResource('/animes/',config);case 3:res=_context2.sent;return _context2.abrupt(\"return\",res.map(_this._transformAnime));case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();this.getRandomCharacters=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(num){var idArray,characters,i,id,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:idArray=[];characters=[];i=0;case 3:if(!(i<num)){_context3.next=24;break;}id=Math.floor(Math.random()*100000);if(!(id in idArray)){_context3.next=9;break;}return _context3.abrupt(\"continue\",3);case 9:idArray.push(id);_context3.prev=10;_context3.next=13;return _this.getResource(\"/characters/\".concat(id));case 13:res=_context3.sent;characters.push(res);_context3.next=21;break;case 17:_context3.prev=17;_context3.t0=_context3[\"catch\"](10);console.log(\"mistake\");return _context3.abrupt(\"continue\",3);case 21:i=i+1;case 22:_context3.next=3;break;case 24:return _context3.abrupt(\"return\",characters.map(_this._transformCharacter));case 25:case\"end\":return _context3.stop();}}},_callee3,null,[[10,17]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();this.getAdditionalOngoings=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var page,num,config,res,_args4=arguments;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:page=_args4.length>0&&_args4[0]!==undefined?_args4[0]:1;num=_args4.length>1&&_args4[1]!==undefined?_args4[1]:10;config={status:\"ongoing\",order:\"ranked\",limit:num,page:page};_context4.next=5;return _this.getResource('/animes/',config);case 5:res=_context4.sent;return _context4.abrupt(\"return\",res.map(_this._transformAnime));case 7:case\"end\":return _context4.stop();}}},_callee4);}));this.getAnime=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return _this.getResource(\"/animes/\".concat(id));case 2:res=_context5.sent;return _context5.abrupt(\"return\",_this._transformAnime(res));case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref5.apply(this,arguments);};}();this.searchAnimes=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(name){var num,config,res,_args6=arguments;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:num=_args6.length>1&&_args6[1]!==undefined?_args6[1]:10;config={order:\"ranked\",limit:num,search:name};_context6.next=4;return _this.getResource('/animes/',config);case 4:res=_context6.sent;return _context6.abrupt(\"return\",res.map(_this._transformAnime));case 6:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x5){return _ref6.apply(this,arguments);};}();this._transformAnime=function(anime){return _objectSpread(_objectSpread({},anime),{},{name:anime.russian,image:\"https://shikimori.one\"+anime.image.original,imageForSearch:\"https://shikimori.one\"+anime.image.x48});};this._transformCharacter=function(character){return{id:character.id,russian:character.russian,image:\"https://shikimori.one\"+character.image.original};};};export{AnimeService as default};","map":{"version":3,"sources":["/Users/aleksandrgolomazov/anime-project/src/services/anime-service.js"],"names":["axios","AnimeService","_apiBase","getResource","url","config","get","params","data","getOngoings","num","status","order","limit","res","map","_transformAnime","getRandomCharacters","idArray","characters","i","id","Math","floor","random","push","console","log","_transformCharacter","getAdditionalOngoings","page","getAnime","searchAnimes","name","search","anime","russian","image","original","imageForSearch","x48","character"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\nexport default class AnimeService {\n    _apiBase = 'https://shikimori.one/api';\n    getResource = async (url, config = {}) => {\n        return (await axios.get(`${this._apiBase}${url}`, { params: config })).data;\n    }\n\n    getOngoings = async (num) => {\n        const config = { status: \"ongoing\", order: \"ranked\", limit: num };\n        const res = await this.getResource('/animes/', config);\n        //res = await Promise.all(res.map(this._transformAnime));\n        return res.map(this._transformAnime);\n    }\n    //30735 creates the mistake \n    getRandomCharacters = async (num) => {\n        const idArray = [];\n        const characters = [];\n        let i = 0;\n        while (i < num) {\n            const id = Math.floor(Math.random() * 100000);\n            if (id in idArray) continue\n            else {\n                idArray.push(id)\n                try {\n                    const res = await this.getResource(`/characters/${id}`);\n                    characters.push(res);\n                }\n                catch {\n                    console.log(\"mistake\")\n                    continue\n                }\n                i = i + 1;\n            }\n        }\n        return characters.map(this._transformCharacter)\n    }\n\n    getAdditionalOngoings = async (page = 1, num = 10) => {\n        const config = { status: \"ongoing\", order: \"ranked\", limit: num, page: page };\n        const res = await this.getResource('/animes/', config);\n        return res.map(this._transformAnime);\n\n    }\n\n    getAnime = async (id) => {\n        const res = await this.getResource(`/animes/${id}`);\n        return this._transformAnime(res);\n    }\n\n    searchAnimes = async (name, num = 10) => {\n        const config = { order: \"ranked\", limit: num, search: name };\n        const res = await this.getResource('/animes/', config);\n        return res.map(this._transformAnime);\n    }\n\n    _transformAnime = (anime) => {\n        return {\n            ...anime,\n            name: anime.russian,\n            image: \"https://shikimori.one\" + anime.image.original,\n            imageForSearch: \"https://shikimori.one\" + anime.image.x48\n        }\n    }\n\n    _transformCharacter = (character) => {\n        return {\n            id: character.id,\n            russian: character.russian,\n            image: \"https://shikimori.one\" + character.image.original\n        }\n    }\n\n\n}"]},"metadata":{},"sourceType":"module"}