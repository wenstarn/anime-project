{"ast":null,"code":"import _classCallCheck from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import'./anime-list.css';import AnimeListItem from\"../anime-list-item\";import{connect}from\"react-redux\";import withAnimeService from\"../hoc\";import*as actions from'../../actions';import{withRouter}from\"react-router\";import*as qs from'qs';import{jsx as _jsx}from\"react/jsx-runtime\";var AnimeList=function AnimeList(_ref){var animes=_ref.animes;return/*#__PURE__*/_jsx(\"ul\",{className:\"anime-list\",children:animes.map(function(anime){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(AnimeListItem,{title:anime.name,image:anime.image,id:anime.id})},anime.id);})});};var AnimeListContainer=/*#__PURE__*/function(_Component){_inherits(AnimeListContainer,_Component);var _super=_createSuper(AnimeListContainer);function AnimeListContainer(){var _this;_classCallCheck(this,AnimeListContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.scroll=function(){var block=document.querySelector('.anime-list');var contentHeight=block.offsetHeight;var yOffset=window.pageYOffset;var window_height=window.innerHeight;var y=yOffset+window_height;if(y>=contentHeight){console.log(_assertThisInitialized(_this));_this.props.animeListAnimesRequested();_this.props.animeService.getAdditionalOngoings(_this.props.page,15).then(function(res){return _this.props.animeListAnimesLoaded(res);});}};return _this;}_createClass(AnimeListContainer,[{key:\"componentDidMount\",value:function componentDidMount(){this.props.animeListRequested();this.searchCheck();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(this.props.location!==prevProps.location){var _qs$parse=qs.parse(this.props.location.search,{ignoreQueryPrefix:true}),search=_qs$parse.search;this.props.animeListRequested();this.searchCheck();}}},{key:\"searchCheck\",value:function searchCheck(){var _this2=this;var _qs$parse2=qs.parse(this.props.location.search,{ignoreQueryPrefix:true}),search=_qs$parse2.search;if(search){this.props.animeService.searchAnimes(search,30).then(function(res){return _this2.props.animeListLoaded(res);});window.removeEventListener('scroll',this.scroll,false);}else{this.props.animeService.getOngoings(15).then(function(res){return _this2.props.animeListLoaded(res);});window.addEventListener('scroll',this.scroll,false);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('scroll',this.scroll,false);}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(AnimeList,{animes:this.props.animes});}}]);return AnimeListContainer;}(Component);var mapStatetoProps=function mapStatetoProps(_ref2){var _ref2$animeList=_ref2.animeList,animes=_ref2$animeList.animes,loading=_ref2$animeList.loading,error=_ref2$animeList.error,page=_ref2$animeList.page;return{animes:animes,loading:loading,error:error,page:page};};export default withRouter(withAnimeService()(connect(mapStatetoProps,actions)(AnimeListContainer)));","map":{"version":3,"sources":["/Users/aleksandrgolomazov/anime_project/src/components/anime-list/anime-list.js"],"names":["React","Component","AnimeListItem","connect","withAnimeService","actions","withRouter","qs","AnimeList","animes","map","anime","name","image","id","AnimeListContainer","scroll","block","document","querySelector","contentHeight","offsetHeight","yOffset","window","pageYOffset","window_height","innerHeight","y","console","log","props","animeListAnimesRequested","animeService","getAdditionalOngoings","page","then","res","animeListAnimesLoaded","animeListRequested","searchCheck","prevProps","location","parse","search","ignoreQueryPrefix","searchAnimes","animeListLoaded","removeEventListener","getOngoings","addEventListener","mapStatetoProps","animeList","loading","error"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport './anime-list.css';\nimport AnimeListItem from \"../anime-list-item\";\nimport { connect } from \"react-redux\";\nimport withAnimeService from \"../hoc\";\nimport * as actions from '../../actions'\nimport { withRouter } from \"react-router\";\nimport * as qs from 'qs';\n\n\nconst AnimeList = ({ animes }) => {\n    return (\n        <ul className=\"anime-list\">\n            {\n                animes.map((anime) => {\n                    return (\n                        <li key={anime.id} >\n                            <AnimeListItem title={anime.name} image={anime.image} id={anime.id} />\n                        </li>\n                    )\n                })\n            }\n        </ul>\n    )\n}\n\nclass AnimeListContainer extends Component {\n\n    componentDidMount() {\n        this.props.animeListRequested()\n        this.searchCheck()\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.location !== prevProps.location) {\n            const { search } = (qs.parse(this.props.location.search, { ignoreQueryPrefix: true }))\n            this.props.animeListRequested()\n            this.searchCheck()\n        }\n    }\n\n    searchCheck() {\n        const { search } = (qs.parse(this.props.location.search, { ignoreQueryPrefix: true }))\n        if (search) {\n            this.props.animeService.searchAnimes(search, 30).then(res => this.props.animeListLoaded(res))\n            window.removeEventListener('scroll', this.scroll, false)\n        }\n        else {\n            this.props.animeService.getOngoings(15).then(res => this.props.animeListLoaded(res))\n            window.addEventListener('scroll', this.scroll, false)\n\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('scroll', this.scroll, false)\n    }\n\n    scroll = () => {\n        const block = document.querySelector('.anime-list');\n        const contentHeight = block.offsetHeight;\n        const yOffset = window.pageYOffset;\n        const window_height = window.innerHeight;\n        const y = yOffset + window_height;\n        if (y >= contentHeight) {\n            console.log(this)\n            this.props.animeListAnimesRequested()\n            this.props.animeService.getAdditionalOngoings(this.props.page, 15).then(res => this.props.animeListAnimesLoaded(res))\n        }\n    }\n    render() {\n        return <AnimeList animes={this.props.animes} />\n    }\n\n}\n\nconst mapStatetoProps = ({ animeList: { animes, loading, error, page } }) => {\n    return { animes, loading, error, page };\n};\n\nexport default withRouter(withAnimeService()(connect(mapStatetoProps, actions)(AnimeListContainer)))"]},"metadata":{},"sourceType":"module"}