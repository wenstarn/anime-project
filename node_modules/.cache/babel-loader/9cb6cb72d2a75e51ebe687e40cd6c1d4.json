{"ast":null,"code":"import _classCallCheck from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _slicedToArray from\"/Users/aleksandrgolomazov/anime_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useEffect,useState}from\"react\";import'./anime-details.css';import{connect}from\"react-redux\";import withAnimeService from\"../hoc\";import*as actions from'../../actions';import{withRouter}from\"react-router\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AnimeDetails=function AnimeDetails(_ref){var anime=_ref.anime,removeAnime=_ref.removeAnime,addAnime=_ref.addAnime,myList=_ref.myList,episodesRef=_ref.episodesRef,gradeRef=_ref.gradeRef;var animeListItem=myList.find(function(animeListItem){return animeListItem.id===anime.id;});var _useState=useState(\"No category\"),_useState2=_slicedToArray(_useState,2),category=_useState2[0],setCategory=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),episodes=_useState4[0],setEpisodes=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),grade=_useState6[0],setGrade=_useState6[1];useEffect(function(){if(animeListItem){setCategory(animeListItem.category);setEpisodes(animeListItem.episodes);setGrade(animeListItem.grade);}else{setCategory(\"No category\");setEpisodes(0);setGrade(0);}if(category===\"No category\"){episodesRef.current.style.visibility=\"hidden\";gradeRef.current.style.visibility=\"hidden\";episodesRef.current.style.position=\"absolute\";gradeRef.current.style.position=\"absolute\";}else{episodesRef.current.style.visibility=\"visible\";gradeRef.current.style.visibility=\"visible\";episodesRef.current.style.position=\"static\";gradeRef.current.style.position=\"static\";}if(category===\"Watched\"||category===\"No category\"){episodesRef.current.children[1].children[0].style.visibility=\"hidden\";episodesRef.current.children[1].children[1].style.visibility=\"hidden\";}else{episodesRef.current.children[1].children[0].style.visibility=\"visible\";episodesRef.current.children[1].children[1].style.visibility=\"visible\";}});return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid mt-5 text-light\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-xl-2 col-lg-3 col-md-4 d-flex flex-column justify-content-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:anime.image,className:\"img-fluid rounded mb-3 \"}),/*#__PURE__*/_jsxs(\"select\",{value:category,onChange:selectCategory({category:category,episodes:episodes,grade:grade},{removeAnime:removeAnime,addAnime:addAnime,anime:anime}),class:\"custom-select mb-3\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"No category\",children:\"\\u041D\\u0435\\u0442 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Scheduled\",children:\"\\u0417\\u0430\\u043F\\u043B\\u0430\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u043D\\u043E\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Watching\",children:\"\\u0421\\u043C\\u043E\\u0442\\u0440\\u044E\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Watched\",children:\"\\u041F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u043D\\u043E\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Dropped\",children:\"\\u0411\\u0440\\u043E\\u0448\\u0435\\u043D\\u043E\"})]}),/*#__PURE__*/_jsxs(\"div\",{ref:episodesRef,className:\"mb-3 d-flex justify-content-between align-items-center\",style:{visibility:\"hidden\",position:\"absolute\"},children:[/*#__PURE__*/_jsxs(\"span\",{className:\"\",children:[\"\\u042D\\u043F\\u0438\\u0437\\u043E\\u0434\\u044B: \",/*#__PURE__*/_jsx(\"span\",{children:episodes}),\"/\",/*#__PURE__*/_jsx(\"span\",{children:anime.episodes>0?anime.episodes:anime.episodes_aired})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"btn-group\",role:\"group\",\"aria-label\":\"Basic mixed styles example\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:pushButton(-1,{category:category,episodes:episodes,grade:grade},{removeAnime:removeAnime,addAnime:addAnime,anime:anime}),class:\"btn btn-danger\",children:\"-\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:pushButton(1,{category:category,episodes:episodes,grade:grade},{removeAnime:removeAnime,addAnime:addAnime,anime:anime}),class:\"btn btn-success\",children:\"+\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{ref:gradeRef,className:\"mb-3 d-flex justify-content-center align-items-baseline\",style:{visibility:\"hidden\",position:\"absolute\"},children:[/*#__PURE__*/_jsx(\"span\",{className:\"col-5 p-0\",style:{display:\"inline-block\"},children:\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-warning\",id:\"basic-addon1\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",fill:\"currentColor\",class:\"bi bi-star\",viewBox:\"0 0 16 16\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z\"})})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:grade,onChange:addGrade({category:category,episodes:episodes,grade:grade},{removeAnime:removeAnime,addAnime:addAnime,anime:anime}),className:\"form-control\",placeholder:\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430\",\"aria-label\":\"Grade\",\"aria-describedby\":\"basic-addon1\",max:\"10\",min:\"0\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"\",children:anime.name}),/*#__PURE__*/_jsxs(\"ul\",{className:\"p-0\",children:[/*#__PURE__*/_jsxs(\"li\",{className:\"mb-3\",children:[\"\\u0420\\u0435\\u0439\\u0442\\u0438\\u043D\\u0433: \",/*#__PURE__*/_jsx(\"span\",{className:\"text-secondary\",children:anime.score})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"mb-3\",children:[\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u044D\\u043F\\u0438\\u0437\\u043E\\u0434\\u043E\\u0432:  \",/*#__PURE__*/_jsx(\"span\",{className:\"text-secondary\",children:anime.episodes>0?anime.episodes:anime.episodes_aired})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"mb-3\",children:[\"\\u0416\\u0430\\u043D\\u0440\\u044B: \",anime.genres.map(function(genre,index){if(index!==anime.genres.length-1){return/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary\",children:[\" \",genre.russian,\",\"]});}else{return/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary\",children:[\" \",genre.russian]});}})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"mb-3\",children:[\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435: \",/*#__PURE__*/_jsx(\"span\",{className:\"text-secondary\",children:anime.description})]})]})]})]})});};var selectCategory=function selectCategory(state,animeServ){return function(event){var category=state.category,episodes=state.episodes,grade=state.grade;var removeAnime=animeServ.removeAnime,addAnime=animeServ.addAnime,anime=animeServ.anime;var episodesLimit=anime.episodes>0?anime.episodes:anime.episodes_aired;removeAnime(anime);if(event.target.value!==\"No category\"){if(event.target.value===\"Watched\")episodes=episodesLimit;var animeItem={id:anime.id,name:anime.name,episodes:episodes,grade:grade,category:event.target.value,episodesLimit:episodesLimit};addAnime(animeItem);}};};var pushButton=function pushButton(number,state,animeServ){return function(event){var category=state.category,episodes=state.episodes,grade=state.grade;var removeAnime=animeServ.removeAnime,addAnime=animeServ.addAnime,anime=animeServ.anime;var episodesNum=episodes+number;var episodesLimit=anime.episodes>0?anime.episodes:anime.episodes_aired;removeAnime(anime);if(episodesNum<0)episodesNum=0;if(episodesNum>=episodesLimit){episodesNum=episodesLimit;category=\"Watched\";}var animeItem={id:anime.id,name:anime.name,episodes:episodesNum,grade:grade,category:category,episodesLimit:episodesLimit};addAnime(animeItem);};};var addGrade=function addGrade(state,animeServ){return function(event){var category=state.category,episodes=state.episodes,grade=state.grade;var removeAnime=animeServ.removeAnime,addAnime=animeServ.addAnime,anime=animeServ.anime;var episodesLimit=anime.episodes>0?anime.episodes:anime.episodes_aired;var value=event.target.value;if(value>10)value=10;if(value<0)value=0;removeAnime(anime);var animeItem={id:anime.id,name:anime.name,episodes:episodes,grade:value,category:category,episodesLimit:episodesLimit};addAnime(animeItem);};};var AnimeDetailsContainer=/*#__PURE__*/function(_Component){_inherits(AnimeDetailsContainer,_Component);var _super=_createSuper(AnimeDetailsContainer);function AnimeDetailsContainer(props){var _this;_classCallCheck(this,AnimeDetailsContainer);_this=_super.call(this,props);_this.episodes=/*#__PURE__*/React.createRef();_this.grade=/*#__PURE__*/React.createRef();_this.category=/*#__PURE__*/React.createRef();return _this;}_createClass(AnimeDetailsContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.props.animeRequested();this.props.animeService.getAnime(this.props.id).then(function(res){return _this2.props.animeLoaded(res);});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _this3=this;if(prevProps.location!=this.props.location){console.log(\"detail update\");this.props.animeRequested();this.props.animeService.getAnime(this.props.id).then(function(res){return _this3.props.animeLoaded(res);});}}},{key:\"render\",value:function render(){if(Object.keys(this.props.anime).length){return/*#__PURE__*/_jsx(AnimeDetails,{anime:this.props.anime,episodesRef:this.episodes,gradeRef:this.grade,removeAnime:this.props.removeFromMyList,addAnime:this.props.addToMyList,myList:this.props.animes,category:this.category});}else{return\"nnnn\";}}}]);return AnimeDetailsContainer;}(Component);var mapStatetoProps=function mapStatetoProps(_ref2){var _ref2$animeDetails=_ref2.animeDetails,anime=_ref2$animeDetails.anime,loading=_ref2$animeDetails.loading,error=_ref2$animeDetails.error,animes=_ref2.myList.animes;return{anime:anime,loading:loading,error:error,animes:animes};};export default withRouter(withAnimeService()(connect(mapStatetoProps,actions)(AnimeDetailsContainer)));","map":{"version":3,"sources":["/Users/aleksandrgolomazov/anime_project/src/components/anime-details/anime-details.js"],"names":["React","Component","useEffect","useState","connect","withAnimeService","actions","withRouter","AnimeDetails","anime","removeAnime","addAnime","myList","episodesRef","gradeRef","animeListItem","find","id","category","setCategory","episodes","setEpisodes","grade","setGrade","current","style","visibility","position","children","image","selectCategory","episodes_aired","pushButton","display","addGrade","name","score","genres","map","genre","index","length","russian","description","state","animeServ","event","episodesLimit","target","value","animeItem","number","episodesNum","AnimeDetailsContainer","props","createRef","animeRequested","animeService","getAnime","then","res","animeLoaded","prevProps","location","console","log","Object","keys","removeFromMyList","addToMyList","animes","mapStatetoProps","animeDetails","loading","error"],"mappings":"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","sourcesContent":["import React, { Component, useEffect, useState } from \"react\";\nimport './anime-details.css'\nimport { connect } from \"react-redux\";\nimport withAnimeService from \"../hoc\";\nimport * as actions from '../../actions'\nimport { withRouter } from \"react-router\";\n\n\nconst AnimeDetails = ({ anime, removeAnime, addAnime, myList, episodesRef, gradeRef }) => {\n    const animeListItem = myList.find(animeListItem => animeListItem.id === anime.id);\n    const [category, setCategory] = useState(\"No category\")\n    const [episodes, setEpisodes] = useState(0)\n    const [grade, setGrade] = useState(0)\n    useEffect(() => {\n        if (animeListItem) {\n            setCategory(animeListItem.category);\n            setEpisodes(animeListItem.episodes);\n            setGrade(animeListItem.grade);\n        }\n        else {\n            setCategory(\"No category\")\n            setEpisodes(0)\n            setGrade(0)\n        }\n\n        if (category === \"No category\") {\n            episodesRef.current.style.visibility = \"hidden\"\n            gradeRef.current.style.visibility = \"hidden\"\n            episodesRef.current.style.position = \"absolute\"\n            gradeRef.current.style.position = \"absolute\"\n\n        }\n        else {\n            episodesRef.current.style.visibility = \"visible\"\n            gradeRef.current.style.visibility = \"visible\"\n            episodesRef.current.style.position = \"static\"\n            gradeRef.current.style.position = \"static\"\n        }\n\n        if (category === \"Watched\" || category === \"No category\") {\n            episodesRef.current.children[1].children[0].style.visibility = \"hidden\"\n            episodesRef.current.children[1].children[1].style.visibility = \"hidden\"\n        }\n        else {\n            episodesRef.current.children[1].children[0].style.visibility = \"visible\"\n            episodesRef.current.children[1].children[1].style.visibility = \"visible\"\n        }\n    })\n    return (\n        <div className=\"container-fluid mt-5 text-light\" >\n            <div className=\"row\">\n                <div className=\"col-xl-2 col-lg-3 col-md-4 d-flex flex-column justify-content-center\">\n                    <img src={anime.image} className=\"img-fluid rounded mb-3 \" />\n                    <select value={category} onChange={selectCategory({ category, episodes, grade },\n                        { removeAnime, addAnime, anime })} class=\"custom-select mb-3\">\n                        <option value=\"No category\">Нет категории</option>\n                        <option value=\"Scheduled\">Запланированно</option>\n                        <option value=\"Watching\">Смотрю</option>\n                        <option value=\"Watched\">Просмотрено</option>\n                        <option value=\"Dropped\">Брошено</option>\n                    </select>\n                    <div ref={episodesRef} className=\"mb-3 d-flex justify-content-between align-items-center\" style={{ visibility: \"hidden\", position: \"absolute\" }}>\n                        <span className=\"\">Эпизоды: <span>{episodes}</span>/<span>{anime.episodes > 0 ? anime.episodes : anime.episodes_aired}</span></span>\n                        <div class=\"btn-group\" role=\"group\" aria-label=\"Basic mixed styles example\">\n                            <button type=\"button\" onClick={pushButton(-1, { category, episodes, grade },\n                                { removeAnime, addAnime, anime })} class=\"btn btn-danger\">-</button>\n                            <button type=\"button\" onClick={pushButton(1, { category, episodes, grade },\n                                { removeAnime, addAnime, anime })} class=\"btn btn-success\">+</button>\n                        </div>\n                    </div>\n                    <div ref={gradeRef} className=\"mb-3 d-flex justify-content-center align-items-baseline\" style={{ visibility: \"hidden\", position: \"absolute\" }}>\n                        <span className=\"col-5 p-0\" style={{ display: \"inline-block\" }}>Оценка:</span>\n                        <div className=\"input-group mb-3\">\n                            <span className=\"input-group-text bg-warning\" id=\"basic-addon1\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-star\" viewBox=\"0 0 16 16\">\n                                <path d=\"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z\" />\n                            </svg></span>\n                            <input type=\"number\" value={grade} onChange={addGrade({ category, episodes, grade },\n                                { removeAnime, addAnime, anime })} className=\"form-control\" placeholder=\"Оценка\" aria-label=\"Grade\" aria-describedby=\"basic-addon1\" max=\"10\" min=\"0\" />\n                        </div>\n\n                    </div>\n                </div>\n                <div className=\"col\">\n                    <h1 className=\"\">{anime.name}</h1>\n                    <ul className=\"p-0\">\n                        <li className=\"mb-3\">Рейтинг: <span className=\"text-secondary\">{anime.score}</span></li>\n                        <li className=\"mb-3\">Количество эпизодов:  <span className=\"text-secondary\">{anime.episodes > 0 ? anime.episodes : anime.episodes_aired}</span></li>\n                        <li className=\"mb-3\">Жанры: {anime.genres.map((genre, index) => {\n\n                            if (index !== anime.genres.length - 1) {\n                                return (\n                                    <span className=\"text-secondary\"> {genre.russian},</span>\n                                )\n                            }\n                            else {\n                                return (\n                                    <span className=\"text-secondary\"> {genre.russian}</span>\n                                )\n                            }\n                        }\n                        )}</li>\n                        <li className=\"mb-3\">Описание: <span className=\"text-secondary\">{anime.description}</span></li>\n                    </ul>\n                </div>\n\n            </div>\n        </div >\n\n    )\n}\n\nconst selectCategory = (state, animeServ) => (event) => {\n    let { category, episodes, grade } = state;\n    const { removeAnime, addAnime, anime } = animeServ;\n    const episodesLimit = anime.episodes > 0 ? anime.episodes : anime.episodes_aired;\n    removeAnime(anime)\n    if (event.target.value !== \"No category\") {\n        if (event.target.value === \"Watched\") episodes = episodesLimit;\n        const animeItem = { id: anime.id, name: anime.name, episodes, grade, category: event.target.value, episodesLimit }\n        addAnime(animeItem)\n    }\n}\n\nconst pushButton = (number, state, animeServ) => (event) => {\n    let { category, episodes, grade } = state;\n    const { removeAnime, addAnime, anime } = animeServ;\n    let episodesNum = episodes + number;\n    const episodesLimit = anime.episodes > 0 ? anime.episodes : anime.episodes_aired;\n    removeAnime(anime)\n    if (episodesNum < 0) episodesNum = 0\n    if (episodesNum >= episodesLimit) {\n        episodesNum = episodesLimit\n        category = \"Watched\"\n    }\n    const animeItem = { id: anime.id, name: anime.name, episodes: episodesNum, grade, category, episodesLimit }\n    addAnime(animeItem)\n}\n\nconst addGrade = (state, animeServ) => (event) => {\n    let { category, episodes, grade } = state;\n    const { removeAnime, addAnime, anime } = animeServ;\n    const episodesLimit = anime.episodes > 0 ? anime.episodes : anime.episodes_aired;\n    let value = event.target.value;\n    if (value > 10) value = 10\n    if (value < 0) value = 0\n    removeAnime(anime)\n    const animeItem = { id: anime.id, name: anime.name, episodes, grade: value, category, episodesLimit }\n    addAnime(animeItem)\n}\nclass AnimeDetailsContainer extends Component {\n    constructor(props) {\n        super(props)\n        this.episodes = React.createRef();\n        this.grade = React.createRef();\n        this.category = React.createRef();\n\n    }\n\n    componentDidMount() {\n        this.props.animeRequested()\n        this.props.animeService.getAnime(this.props.id).then(res => this.props.animeLoaded(res))\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.location != this.props.location) {\n            console.log(\"detail update\")\n\n            this.props.animeRequested()\n            this.props.animeService.getAnime(this.props.id).then(res => this.props.animeLoaded(res))\n        }\n\n    }\n\n    render() {\n        if (Object.keys(this.props.anime).length) {\n            return <AnimeDetails anime={this.props.anime} episodesRef={this.episodes}\n                gradeRef={this.grade} removeAnime={this.props.removeFromMyList} addAnime={this.props.addToMyList}\n                myList={this.props.animes} category={this.category} />\n        }\n        else {\n            return \"nnnn\"\n        }\n    }\n}\n\n\n\nconst mapStatetoProps = ({ animeDetails: { anime, loading, error }, myList: { animes } }) => {\n    return { anime, loading, error, animes };\n};\n\nexport default withRouter(withAnimeService()(connect(mapStatetoProps, actions)(AnimeDetailsContainer)))\n"]},"metadata":{},"sourceType":"module"}